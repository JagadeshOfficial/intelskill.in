// Firebase Storage security rules for LearnFlow
// Permit authenticated users (including anonymous when enabled) to
// upload and read files placed under the courses/<course>/batches/<batch>/ path.
// All other paths are locked down by default.

rules_version = '2';

service firebase.storage {
	match /b/{bucket}/o {
		// Allow authenticated users to read and write files inside the
		// courses/{courseId}/batches/{batchId}/... folder structure.
		match /courses/{courseId}/batches/{batchId}/{allPaths=**} {
			allow read: if request.auth != null; // require auth to list/download
			allow write: if request.auth != null; // require auth to upload/delete
		}

		// You can add additional safe folders below if needed (for tutors, avatars, etc.)
		// Deny everything else by default.
		match /{allPaths=**} {
			allow read: if false;
			allow write: if false;
		}
	}
}

